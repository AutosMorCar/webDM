<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DM Automoci√≥n</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --dm-marble: #f5f5f3;
      --dm-marble-soft: #ededeb;
      --dm-black: #0f0f0f;
      --dm-black-soft: #1a1a1a;
      --dm-grey: #7a7a7a;
      --dm-border: #d6d6d3;
    }

    body {
  margin: 0;
  padding: 0;
  font-family: 'Inter', sans-serif;
  color: var(--dm-black);

  background-color: #f4f4f2;
  background-image: url("marmol.avif");
  background-repeat: no-repeat;
  background-size: cover;
  background-position: center top;
  background-attachment: fixed;
}

    header, footer {
      position: fixed;
      left: 0;
      right: 0;
      z-index: 999;
      transition: transform 0.3s ease;
    }

    header {
      background: var(--dm-black);
      padding: 15px 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      top: 0;
    }

    footer {
      background: var(--dm-black);
      color: #ccc;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 13px;
      padding: 6px 20px;
      height: 40px;
      bottom: 0;
      border-top: 1px solid rgba(255,255,255,0.1);
    }

      footer a {
  color: #ccc;
  text-decoration: none;
  font-weight: 500;
}

footer a:hover {
  color: white;
  text-decoration: underline;
}

    nav a,
    nav button {
      color: white;
      text-decoration: none;
      margin-left: 20px;
      font-weight: bold;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }

    .contenedor-principal {
      display: flex;
      padding: 120px 30px 80px;
      gap: 30px;
      align-items: flex-start;
    }

    .barra-lateral {
      position: sticky;
      top: 80px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    /* ===============================
       FILTROS ‚Äì IGUAL QUE MORCAR
       =============================== */

    aside {
  width: 250px;
  background-color: #111;
  padding: 20px;
  border-radius: 10px;
  display: flex;
  flex-direction: column;
  gap: 15px;
  position: sticky;
  top: 80px;
}

    aside h2 {
      color: white;
    }

    aside label {
  font-weight: bold;
  margin-bottom: 5px;
  color: white;
}

    aside select,
aside input {
  padding: 8px;
  border: none;
  border-radius: 5px;
  background-color: #1c1c1c;
  color: white;
  width: 100%;
  box-sizing: border-box;
}

aside button {
  padding: 10px;
  background-color: #000; /* DM en vez de rojo */
  color: white;
  font-weight: bold;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

    /* Precio */
.precio-rango {
  display: flex;
  gap: 10px;
}

    .precio-rango .campo-precio {
  display: flex;
  flex-direction: column;
  flex: 1;
}

    .precio-rango .campo-precio span {
  font-size: 12px;
  color: #aaaaaa;
  margin-bottom: 4px;
}

    #filtro-reset {
      margin-top: 6px;
      height: 36px;
      font-size: 14px;
      font-weight: 600;
      background: linear-gradient(to right, #1a1a1a, #000);
      color: white;
      border-radius: 6px;
      border: none;
      box-shadow: 0 0 12px rgba(0,0,0,0.6);
      cursor: pointer;
    }

    #boton-flotante-contacto {
      width: 260px;
      background: linear-gradient(to right, #1a1a1a, #000);
      color: white;
      font-weight: 600;
      border-radius: 10px;
      padding: 14px;
      box-shadow: 0 0 14px rgba(0,0,0,0.6);
      border: none;
      cursor: pointer;
    }

    /* ===============================
       RESTO SIN CAMBIOS
       =============================== */

    main { flex: 1; }

    #resultados {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 24px;
}

    @media (max-width: 1024px) {
  .contenedor-principal {
    flex-direction: column;
    padding: 120px 20px 80px;
  }

  .barra-lateral {
    width: 100%;
    align-items: center;
    position: static;
  }

  .barra-lateral aside {
    width: 90%;
    max-width: 400px;
  }

  aside {
    width: 100%;
    position: static;
  }

  main {
    width: 100%;
  }

  #resultados {
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  }
}


  @media (max-width: 600px) {

  .contenedor-principal {
  padding: 130px 15px 70px; /* m√°s espacio para el header */
}

   header {
    padding: 16px 18px;
    flex-direction: column;
    align-items: flex-start;
    gap: 14px;
  }

  header nav {
    width: 100%;
    display: flex;
    justify-content: space-between;
  }

  header nav a,
  header nav button {
    margin-left: 0;
    font-size: 15px;
  }

  .acciones-contacto {
    display: flex;
    flex-direction: column;
    gap: 14px;
    margin-top: 18px;
  }

  #btn-editar {
    margin-top: 18px;
  }
  
  .barra-lateral {
    margin-top: 10px;
  }

  aside {
    margin-top: 10px;
    position: relative;
    top: 0;
  }

  #resultados {
    grid-template-columns: 1fr;
  }
}

.coche {
  background: linear-gradient(180deg, #0f0f0f, #1a1a1a);
  border-radius: 6px;

  /* üî• borde visible pero elegante */
  border: 3px solid rgba(0,0,0,0.25);

  /* üî• sombra real */
  box-shadow:
    0 12px 30px rgba(0,0,0,0.25),
    0 2px 8px rgba(0,0,0,0.15);

  transition: transform .2s ease, box-shadow .2s ease;
  display: flex;
  flex-direction: column;
  width: 100%;
}


    .coche:hover {
      transform: translateY(-6px);
  box-shadow:
    0 18px 45px rgba(0,0,0,0.35),
    0 6px 16px rgba(0,0,0,0.25);
}

    .coche img {
      width: 100%;
      border-radius: 5px 5px 0 0;
    }

    .info {
  padding: 15px;
  display: flex;
  flex-direction: column;
  height: 100%;
  flex-grow: 1;
}

    .info h3 {
  min-height: 44px; /* üî• fuerza misma altura de t√≠tulo */
  margin: 0 0 14px;
  color: #ffffff;
  font-size: 18px;
  line-height: 1.3;
}

    .info p {
  margin: 6px 0;
  font-size: 15px;
  color: #ffffff;
  line-height: 1.4;
}

    .info .precio {
      color: var(rgb(255, 255, 255));
      font-weight: 600;
    }

    .ver-detalles {
  margin-top: auto; /* üî• empuja el bot√≥n abajo */
  padding: 10px 0px;
  background: rgb(255, 255, 255);
  color: rgb(0, 0, 0);
  align-self: stretch;
  border-radius: 8px;
  font-size: 14px;
  font-weight: bold;
  text-decoration: none;
  text-align: center;
}

    #login-modal {
  display: none;
  position: fixed;
  inset: 0;
  background-color: rgba(0, 0, 0, 0.85);
  z-index: 2000;
  justify-content: center;
  align-items: center;
}

#login-modal .modal-content {
  position: relative;
  background-color: #1a1a1a;
  padding: 30px 25px;
  border-radius: 14px;
  width: 340px;
  box-shadow: 0 0 35px rgba(0, 0, 0, 0.7);
  display: flex;
  flex-direction: column;
  gap: 14px;
  animation: fadeIn 0.2s ease-in-out;
}

#login-modal h2 {
  color: white;
  margin: 0 0 10px;
}

#login-modal input {
  padding: 12px;
  border-radius: 8px;
  border: none;
  background: #2a2a2a;
  color: white;
  font-size: 14px;
}

#login-modal button {
  background: #000;
  color: white;
  padding: 12px;
  font-weight: 600;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

#login-modal .close-btn {
  position: absolute;
  top: 10px;
  right: 12px;
  font-size: 20px;
  background: none;
  border: none;
  color: #ff4c4c;
  cursor: pointer;
}

/* Animaci√≥n */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}


  </style>

  <link rel="icon" type="image/png" href="favicon.ico">
</head>
<body>

<header id="main-header">
  <a href="index.html" style="display: flex; align-items: center; gap: 10px; text-decoration: none;">
    <span style="font-size: 36px; font-weight: 600; color: white;">DM Automoci√≥n</span>
    <!--Poner Bandera <img src="bandera.png" alt="bandera" style="height: 34px; vertical-align: middle;">-->
  </a>
  <nav>
    <a href="index.html">Inicio</a>
    <button id="login-btn" onclick="mostrarLogin()">Login</button>
    <button id="logout-btn" onclick="cerrarSesion()" style="display:none;">Cerrar Sesi√≥n</button>
  </nav>
</header>

<!-- Modal de login -->
<div id="login-modal">
  <div class="modal-content">
    <button class="close-btn" onclick="ocultarLogin()">√ó</button>
    <h2>Iniciar sesi√≥n</h2>
    <input type="text" id="usuario" placeholder="Usuario" />
    <input type="password" id="password" placeholder="Contrase√±a" />
    <button onclick="loginAdmin()">Entrar</button>
    <p id="login-error" style="color:red;"></p>
  </div>
</div>

<div class="contenedor-principal">
  <div class="barra-lateral">
    <aside>
      <h2>Filtros</h2>

      <label for="filtro-buscar">Buscar</label>
      <input id="filtro-buscar" type="text" placeholder="Ej: seat leon" />

      <label for="filtro-tipo">Tipo</label>
      <select id="filtro-tipo">
        <option value="">Todos</option>
        <option value="coches">Coches</option>
        <option value="furgonetas">Furgonetas</option>
      </select>

      <label for="filtro-marca">Marca</label>
      <select id="filtro-marca">
        <option value="">Todas</option>
      </select>

      <!-- üî• Rango de precio moderno en una sola l√≠nea -->
      <label for="filtro-precio-min">Precio (‚Ç¨)</label>
      <div class="precio-rango">
        <div class="campo-precio">
          <span>M√≠n.</span>
          <input
            type="number"
            id="filtro-precio-min"
            placeholder="Desde"
            min="0"
          />
        </div>
        <div class="campo-precio">
          <span>M√°x.</span>
          <input
            type="number"
            id="filtro-precio-max"
            placeholder="Hasta"
            min="0"
          />
        </div>
      </div>

      <button id="filtro-reset">Reset</button>
    </aside>

  </div>

  <main>
    <div id="form-wrapper" style="display:none;">
      <form id="form-coche" enctype="multipart/form-data" style="margin-bottom: 30px;">
        <h2>Subir nuevo coche</h2>
        <input type="text" name="marca" placeholder="Marca" required /><br><br>
        <input type="text" name="modelo" placeholder="Modelo" required /><br><br>
        <input type="number" name="precio" placeholder="Precio (‚Ç¨)" required /><br><br>
        <input type="number" name="anio" placeholder="A√±o" required /><br><br>
        <input type="number" name="km" placeholder="Kil√≥metros" required /><br><br>
        <select name="tipo" required>
          <option value="">Tipo de veh√≠culo</option>
          <option value="coches">Coches</option>
          <option value="furgonetas">Furgonetas</option>
        </select><br><br>

        <textarea name="descripcion" id="descripcion" placeholder="Pega aqu√≠ la descripci√≥n completa..." rows="6" style="width:100%;"></textarea><br><br>
        <button type="button" onclick="extraerCaracteristicas()">Detectar caracter√≠sticas</button><br><br>
        <input type="text" name="caracteristicas" id="caracteristicas" placeholder="Ej: Aire acondicionado, Elevalunas..." style="width:100%;" /><br><br>

        <!-- ‚úÖ OBSERVACIONES NUEVAS -->
        <label for="observaciones">Observaciones (una por l√≠nea)</label>
        <textarea name="observaciones" id="observaciones" rows="4" style="width:100%;"
          placeholder="Motor cambiado&#10;Transmisi√≥n revisada&#10;Golpe en aleta derecha"></textarea><br><br>

        <input type="file" id="imagenes" name="imagenes" multiple required/><br><br>
        <div id="preview" style="display: flex; gap: 10px; flex-wrap: wrap;"></div><br>
        <button type="submit">Subir coche</button>
      </form>
    </div>

    <div id="resultados" class="coche-grid"></div>
  </main>
</div>

<footer id="main-footer">
  <span>&copy; 2026 DM Automoci√≥n. Todos los derechos reservados.</span>
  <div>
    <a href="#">Aviso legal</a> |
    <a href="#">Pol√≠tica de privacidad</a> |
    <a href="#">Cookies</a>
  </div>
</footer>

<script>
  let prevScrollpos = window.pageYOffset;
  window.onscroll = function () {
    const currentScrollPos = window.pageYOffset;
    const header = document.getElementById("main-header");
    const footer = document.getElementById("main-footer");
    if (prevScrollpos > currentScrollPos) {
      header.style.transform = "translateY(0)";
      footer.style.transform = "translateY(0)";
    } else {
      header.style.transform = "translateY(-100%)";
      footer.style.transform = "translateY(100%)";
    }
    prevScrollpos = currentScrollPos;
  };

  function extraerCaracteristicas() {
    const descripcion = document.getElementById("descripcion").value.toLowerCase();
    const lista = [
      "xenon", "pantalla de navegador", "gps", "climatizador", "aire acondicionado",
      "bluetooth", "usb", "camara trasera", "asientos calefactables", "asientos en piel",
      "volante multifuncion", "cierre con mando", "llantas", "ordenador de abordo",
      "techo solar", "dos llaves", "sensores de aparcamiento", "cambio autom√°tico",
      "manual", "autom√°tico", "gasolina", "di√©sel", "navegador", "radio cd",
      "control de velocidad", "velocidad crucero"
    ];

    const encontradas = lista.filter(car => descripcion.includes(car));
    document.getElementById("caracteristicas").value = [...new Set(encontradas)].join(", ");
  }
</script>

<script>
  function mostrarFormularioContacto() {
    document.getElementById("contacto-overlay").style.display = "flex";
  }

  function ocultarFormularioContacto() {
    document.getElementById("contacto-overlay").style.display = "none";
  }

  document.getElementById("form-contacto-header").addEventListener("submit", async (e) => {
    e.preventDefault();

    const form = e.target;
    const formData = new FormData(form);

    try {
      const res = await fetch("/api/buscocoche", {
        method: "POST",
        body: formData
      });

      if (res.ok) {
        alert("‚úÖ Tu solicitud ha sido enviada correctamente.");
        form.reset();
        ocultarFormularioContacto();
      } else {
        alert("‚ùå Hubo un error al enviar la solicitud.");
      }
    } catch (err) {
      console.error("‚ùå Error de conexi√≥n:", err);
      alert("‚ùå Error de conexi√≥n.");
    }
  });
</script>

<script src="script.js"></script>

</body>
</html>
